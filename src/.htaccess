RewriteEngine On
# =========================
# 1. PROTEZIONE
# =========================
RewriteRule ^\.env$ - [F,L]

RewriteCond %{REQUEST_URI} ^/test.*\.php$ [NC]
RewriteRule ^ - [L]

# =========================
# 2. REDIRECT ESTERNO
# Togli .html e .php dall'URL
# (solo GET, non POST)
# =========================
RewriteCond %{REQUEST_METHOD} !POST [NC]
RewriteCond %{THE_REQUEST} \s/+(.+?)\.(html|php)[\s?] [NC]
RewriteRule ^ /%1 [R=301,NE,L]

# =========================
# 3. REWRITE INTERNO HTML
# /pagina → pagina.html
# =========================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^([^\.]+)$ $1.html [NC,L]

# =========================
# 4. REWRITE INTERNO PHP
# /azione → azione.php
# =========================
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# =========================
# 5. PAGINE DI ERRORE
# =========================
ErrorDocument 404 /errori/404.html
ErrorDocument 401 /errori/401.html
ErrorDocument 500 /errori/500.html
